<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/"/>

    <title>microtool.gradient_sampling package &#8212; MICROtool 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css"/>
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css"/>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>

    <link rel="stylesheet" href="../_static/custom.css" type="text/css"/>


    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9"/>

</head>
<body>


<div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">


            <div class="body" role="main">

                <section id="module-microtool.gradient_sampling">
                    <span id="microtool-gradient-sampling-package"></span>
                    <h1>microtool.gradient_sampling package<a class="headerlink"
                                                              href="#module-microtool.gradient_sampling"
                                                              title="Permalink to this heading">¶</a></h1>
                    <section id="submodules">
                        <h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a>
                        </h2>
                    </section>
                    <section id="module-microtool.gradient_sampling.shell_electrostatic">
                        <span id="microtool-gradient-sampling-shell-electrostatic-module"></span>
                        <h2>microtool.gradient_sampling.shell_electrostatic module<a class="headerlink"
                                                                                     href="#module-microtool.gradient_sampling.shell_electrostatic"
                                                                                     title="Permalink to this heading">¶</a>
                        </h2>
                        <p>Module containing sampling scheme for shell organised b-vectors using electrostatic
                            optimization based on the following
                            paper DOI:10.1002/mrm.24736</p>
                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.cost_inter_shell">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span class="pre">cost_inter_shell</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">float</span></span></span><a
                                    class="headerlink"
                                    href="#microtool.gradient_sampling.shell_electrostatic.cost_inter_shell"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Computes the electrostatic energy in each shell individually.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>vectors</strong> – The list of vectors where each
                                        list entry represent a different q-shell</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>Cost/Electrostatic energy</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.cost_intra_shell">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span class="pre">cost_intra_shell</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">float</span></span></span><a
                                    class="headerlink"
                                    href="#microtool.gradient_sampling.shell_electrostatic.cost_intra_shell"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Computes the pairwise electrostatic energy between shell pairs and adds and scales
                                them to penalize similar
                                orientations on different shells.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>vectors</strong> – The list of vector sets of the
                                        different q shells</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>Cost associated with this configuration</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.cost_scipy">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span class="pre">cost_scipy</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em
                                    class="sig-param"><span class="n"><span class="pre">n_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                    class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span
                                    class="pre">alpha</span></span><span class="p"><span
                                    class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                    class="pre">float</span></span><span class="w"> </span><span class="o"><span
                                    class="pre">=</span></span><span class="w"> </span><span class="default_value"><span
                                    class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">float</span></span></span><a
                                    class="headerlink"
                                    href="#microtool.gradient_sampling.shell_electrostatic.cost_scipy"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd">
                                        <ul class="simple">
                                            <li><p><strong>x</strong> – The flat array containing all the vectors</p>
                                            </li>
                                            <li><p><strong>n_shells</strong> – Number of vectors in each shell</p></li>
                                            <li><p><strong>alpha</strong> – The relative weighting of inter and intra
                                                shell cost/electrostatic energy</p></li>
                                        </ul>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>The cost associated with this set of vectors</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.repack_shells">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span class="pre">repack_shells</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em
                                    class="sig-param"><span class="n"><span class="pre">n_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></span><a class="headerlink"
                                                                                href="#microtool.gradient_sampling.shell_electrostatic.repack_shells"
                                                                                title="Permalink to this definition">¶</a>
                            </dt>
                            <dd>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd">
                                        <ul class="simple">
                                            <li><p><strong>x</strong> – A flattened numpy ndarray that you wish to
                                                reorganize in shell structure</p></li>
                                            <li><p><strong>n_shells</strong> – A list containing the number of samples
                                                on each shell</p></li>
                                        </ul>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>The vectors of each shell stored as a seperate list
                                        entry</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.sample_shells_electrostatic">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span
                                    class="pre">sample_shells_electrostatic</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></span><a class="headerlink"
                                                                                href="#microtool.gradient_sampling.shell_electrostatic.sample_shells_electrostatic"
                                                                                title="Permalink to this definition">¶</a>
                            </dt>
                            <dd><p>Samples shells according to the cost functions as defined in DOI:
                                10.1002/mrm.24736</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>n_shells</strong> – A list containing the number of
                                        desired samples per shell</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>A list containing the sphere samples as seperate list
                                        entries</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_electrostatic.test_shells">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_electrostatic.</span></span><span
                                    class="sig-name descname"><span class="pre">test_shells</span></span><span
                                    class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"
                                                                                                 href="#microtool.gradient_sampling.shell_electrostatic.test_shells"
                                                                                                 title="Permalink to this definition">¶</a>
                            </dt>
                            <dd></dd>
                        </dl>

                    </section>
                    <section id="module-microtool.gradient_sampling.shell_rigid_rotation">
                        <span id="microtool-gradient-sampling-shell-rigid-rotation-module"></span>
                        <h2>microtool.gradient_sampling.shell_rigid_rotation module<a class="headerlink"
                                                                                      href="#module-microtool.gradient_sampling.shell_rigid_rotation"
                                                                                      title="Permalink to this heading">¶</a>
                        </h2>
                        <p>Module containing sampling scheme for shell organised b-vectors using rigid rotation
                            optimization based on the following
                            paper DOI:10.1002/mrm.24717</p>
                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_rigid_rotation.cost_scipy">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span class="pre">cost_scipy</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em
                                    class="sig-param"><span class="n"><span class="pre">vec_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">float</span></span></span><a
                                    class="headerlink"
                                    href="#microtool.gradient_sampling.shell_rigid_rotation.cost_scipy"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Should rotate, make a backprojection and then compute cost</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd">
                                        <ul class="simple">
                                            <li><p><strong>x</strong> – Flattend theta,phi in other words polar,
                                                azimuthal pairs</p></li>
                                            <li><p><strong>vec_shells</strong> – The list defining the number of samples
                                                per shell.</p></li>
                                        </ul>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>total electrostatic cost</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.shell_rigid_rotation.main">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span class="pre">main</span></span><span
                                    class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"
                                                                                                 href="#microtool.gradient_sampling.shell_rigid_rotation.main"
                                                                                                 title="Permalink to this definition">¶</a>
                            </dt>
                            <dd></dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_rigid_rotation.rotate_shells">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span class="pre">rotate_shells</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span
                                    class="pre">angles</span></span><span class="p"><span
                                    class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                    class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></span><a class="headerlink"
                                                                                href="#microtool.gradient_sampling.shell_rigid_rotation.rotate_shells"
                                                                                title="Permalink to this definition">¶</a>
                            </dt>
                            <dd><p>Rotates the shells by angles respectively.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd">
                                        <ul class="simple">
                                            <li><p><strong>vec_shells</strong> – samples for every shell as list entry
                                            </p></li>
                                            <li><p><strong>angles</strong> – a set of angles of shape (shells, 2)</p>
                                            </li>
                                        </ul>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>List of vectors rotated by given set of angles.</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_rigid_rotation.rotate_vectors">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span class="pre">rotate_vectors</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span
                                    class="n"><span class="pre">angles</span></span><span class="p"><span
                                    class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                    class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink"
                                    href="#microtool.gradient_sampling.shell_rigid_rotation.rotate_vectors"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd">
                                        <ul class="simple">
                                            <li><p><strong>vectors</strong> – A set of vectors to be rotated, shape
                                                (n_vecs, 3)</p></li>
                                            <li><p><strong>angles</strong> – A polar and azimuthal angle to rotate by
                                                (theta, phi), shape (2,)</p></li>
                                        </ul>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p></p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_rigid_rotation.sample_shells_rotation">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span
                                    class="pre">sample_shells_rotation</span></span><span class="sig-paren">(</span><em
                                    class="sig-param"><span class="n"><span class="pre">n_shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></span><a class="headerlink"
                                                                                href="#microtool.gradient_sampling.shell_rigid_rotation.sample_shells_rotation"
                                                                                title="Permalink to this definition">¶</a>
                            </dt>
                            <dd>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>n_shells</strong> – </p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p></p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py"
                                id="microtool.gradient_sampling.shell_rigid_rotation.verify_rotation">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.shell_rigid_rotation.</span></span><span
                                    class="sig-name descname"><span class="pre">verify_rotation</span></span><span
                                    class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"
                                                                                                 href="#microtool.gradient_sampling.shell_rigid_rotation.verify_rotation"
                                                                                                 title="Permalink to this definition">¶</a>
                            </dt>
                            <dd><p>Quick test to see if it works</p>
                            </dd>
                        </dl>

                    </section>
                    <section id="module-microtool.gradient_sampling.uniform">
                        <span id="microtool-gradient-sampling-uniform-module"></span>
                        <h2>microtool.gradient_sampling.uniform module<a class="headerlink"
                                                                         href="#module-microtool.gradient_sampling.uniform"
                                                                         title="Permalink to this heading">¶</a></h2>
                        <p>Module for uniform electrostatic sampling on the sphere.</p>
                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.uniform.cost_fun">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.uniform.</span></span><span
                                    class="sig-name descname"><span class="pre">cost_fun</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">x</span></span></em><span class="sig-paren">)</span><a
                                    class="headerlink" href="#microtool.gradient_sampling.uniform.cost_fun"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>The cost function that models the energy of point charges
                                :param x: array of shape (ns * 3, ) , (just the flattend unit vector samples)
                                :return: scalar representing the total energy of the system</p>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.uniform.sample_uniform">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.uniform.</span></span><span
                                    class="sig-name descname"><span class="pre">sample_uniform</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">ns</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">int</span></span><span
                                    class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                    class="w"> </span><span class="default_value"><span
                                    class="pre">100</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.uniform.sample_uniform"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Using electrostatic energy minimization we generate uniform samples on the sphere. We
                                keep a lookup table for the
                                samples meaning that if this sample has been previously computed we can load it from the
                                disk.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>ns</strong> – Number of samples on the sphere</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>the unit vectors uniform on sphere in shape (ns,3)</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.uniform.test_uniform">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.uniform.</span></span><span
                                    class="sig-name descname"><span class="pre">test_uniform</span></span><span
                                    class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"
                                                                                                 href="#microtool.gradient_sampling.uniform.test_uniform"
                                                                                                 title="Permalink to this definition">¶</a>
                            </dt>
                            <dd></dd>
                        </dl>

                    </section>
                    <section id="module-microtool.gradient_sampling.utils">
                        <span id="microtool-gradient-sampling-utils-module"></span>
                        <h2>microtool.gradient_sampling.utils module<a class="headerlink"
                                                                       href="#module-microtool.gradient_sampling.utils"
                                                                       title="Permalink to this heading">¶</a></h2>
                        <p>Module for helper functions in gradient_sampling.</p>
                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.angles_to_unitvectors">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">angles_to_unitvectors</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em><span
                                    class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.angles_to_unitvectors"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Returns unit vector given an array of spherical angles
                                :param angles: array in the form theta, phi; polar, azimuthal, shape (n_angles, 2)
                                :return: unit vectors on the sphere of shape (n_vectors, 3)
                                :raises: Value error if the array is not of two angles or incorrect shape</p>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.constraint_function">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">constraint_function</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span
                                    class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.constraint_function"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Computes the difference of the vector lengths from unity.</p>
                                <p>The constraint function according to scipy standards. Meaning f(x) = 0 for equality
                                    type and f(x) &lt;= 0 for
                                    inequality type. (output is allowed to be a 1D array )</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>x</strong> – Parameter vector</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>array with difference from unit length for every
                                        vector</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.get_constraints">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">get_constraints</span></span><span
                                    class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span
                                    class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                    class="pre">dict</span></span></span><a class="headerlink"
                                                                            href="#microtool.gradient_sampling.utils.get_constraints"
                                                                            title="Permalink to this definition">¶</a>
                            </dt>
                            <dd>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Returns<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p>Constraints for keeping vectors of length unity</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.make_sphere">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">make_sphere</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">r</span></span></em><span class="sig-paren">)</span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.make_sphere"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Quick function for generating some points on a sphere for plotting purposes.</p>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.normalize">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">normalize</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vecs</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em><span
                                    class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.normalize"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Normalizes a set of vectors.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>vecs</strong> – An array of shape (n_vecs, 3)</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>Vector set of shape (n_vecs, 3) with each vector length
                                        being unity</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.plot_shells">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">plot_shells</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span
                                    class="pre">,</span></span><span class="w"> </span><span
                                    class="pre">Axes</span><span class="p"><span
                                    class="pre">]</span></span></span></span><a class="headerlink"
                                                                                href="#microtool.gradient_sampling.utils.plot_shells"
                                                                                title="Permalink to this definition">¶</a>
                            </dt>
                            <dd><p>Helper function for plotting q-shell configurations
                                :param shells: List of vector collections for each shell
                                :return: None, makes matplotlib figure. Display using plt.show()</p>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.plot_shells_projected">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">plot_shells_projected</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shells</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">List</span><span class="p"><span
                                    class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span
                                    class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">None</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.plot_shells_projected"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd></dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.plot_vectors">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">plot_vectors</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span
                                    class="n"><span class="pre">title</span></span><span class="p"><span
                                    class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                    class="pre">str</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">None</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.plot_vectors"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Helper function for plotting a set of vectors
                                :param vectors: (num, 3) shaped array of vectors
                                :param title: Title for the plot
                                :return: None, display using plt.show()</p>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.sample_sphere_angles">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">sample_sphere_angles</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">ns</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">int</span></span><span
                                    class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                    class="w"> </span><span class="default_value"><span
                                    class="pre">100</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.sample_sphere_angles"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Makes uniform RANDOM samples on the sphere in terms of spherical angles</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>ns</strong> – Number of samples you wish to take on
                                        the sphere</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>The spherical angles in shape (number of samples, 2)</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.sample_sphere_vectors">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">sample_sphere_vectors</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                    class="pre">ns</span></span><span class="p"><span class="pre">:</span></span><span
                                    class="w"> </span><span class="n"><span class="pre">int</span></span><span
                                    class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                    class="w"> </span><span class="default_value"><span
                                    class="pre">100</span></span></em><span class="sig-paren">)</span> <span
                                    class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.sample_sphere_vectors"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd></dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.total_potential">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">total_potential</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em><span
                                    class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.total_potential"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Computes the potential energy generated between pairs of points.</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>vectors</strong> – an array of shape (n_vec,3)</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>pairwise potential array</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                        <dl class="py function">
                            <dt class="sig sig-object py" id="microtool.gradient_sampling.utils.unitvector_to_angles">
                                <span class="sig-prename descclassname"><span class="pre">microtool.gradient_sampling.utils.</span></span><span
                                    class="sig-name descname"><span class="pre">unitvector_to_angles</span></span><span
                                    class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span
                                    class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                    class="n"><span class="pre">ndarray</span></span></em><span
                                    class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                    class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a
                                    class="headerlink" href="#microtool.gradient_sampling.utils.unitvector_to_angles"
                                    title="Permalink to this definition">¶</a></dt>
                            <dd><p>Gives the polar and azimuthal angle of a unit vector in domains [0,pi] and [-pi,+pi]
                                respectively</p>
                                <dl class="field-list simple">
                                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p><strong>vector</strong> – A unit vector in R^3 or array of
                                        shape (n_vectors,3)</p>
                                    </dd>
                                    <dt class="field-even">Returns<span class="colon">:</span></dt>
                                    <dd class="field-even"><p>array of shape (n_angles, 2)</p>
                                    </dd>
                                    <dt class="field-odd">Raises<span class="colon">:</span></dt>
                                    <dd class="field-odd"><p>ValueError if not unit vector or incorrect dimensions</p>
                                    </dd>
                                </dl>
                            </dd>
                        </dl>

                    </section>
                </section>


            </div>

        </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h1 class="logo"><a href="../index.html">MICROtool</a></h1>


            <h3>Navigation</h3>

            <div class="relations">
                <h3>Related Topics</h3>
                <ul>
                    <li><a href="../index.html">Documentation overview</a>
                        <ul>
                        </ul>
                    </li>
                </ul>
            </div>
            <div id="searchbox" style="display: none" role="search">
                <h3 id="searchlabel">Quick search</h3>
                <div class="searchformwrapper">
                    <form class="search" action="../search.html" method="get">
                        <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off"
                               autocapitalize="off" spellcheck="false"/>
                        <input type="submit" value="Go"/>
                    </form>
                </div>
            </div>
            <script>document.getElementById('searchbox').style.display = "block"</script>


        </div>
    </div>
    <div class="clearer"></div>
</div>
<div class="footer">
    &copy;2023, FWH Otto.

    |
    Powered by <a href="http://sphinx-doc.org/">Sphinx 6.2.1</a>
    &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>

    |
    <a href="../_sources/microtool_api/microtool.gradient_sampling.rst.txt"
       rel="nofollow">Page source</a>
</div>


</body>
</html>